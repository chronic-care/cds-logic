{
  "resourceType": "Library",
  "id": "library-cbp",
  "url": "http://github.com/chronic-care/fhir/Library/library-cbp",
  "version": "1.0.0",
  "name": "ControllingHighBloodPressure_FHIRv400",
  "title": "Controlling High Blood Pressure (CBP)",
  "status": "active",
  "experimental": true,
  "type" : {
    "coding" : [
      {
        "system" : "http://terminology.hl7.org/CodeSystem/library-type",
        "code" : "logic-library",
        "display" : "Logic Library"
      }
    ]
  },
  "relatedArtifact" : [
    {
      "type" : "depends-on",
      "resource" : "Library/library-fhir-helpers"
    }
  ],
  "dataRequirement": [
    {
      "type": "Observation"
    }
  ],
  "content": [
    {
      "contentType": "text/cql",
      "data": "bGlicmFyeSBDb250cm9sbGluZ0hpZ2hCbG9vZFByZXNzdXJlX0ZISVJ2NDAwIHZlcnNpb24gJzEuMC4wJwoKLyoKQ29udHJvbGxpbmcgSGlnaCBCbG9vZCBQcmVzc3VyZSAoQ0JQKQoqLwoKdXNpbmcgRkhJUiB2ZXJzaW9uICc0LjAuMCcKCmluY2x1ZGUgRkhJUkhlbHBlcnMgdmVyc2lvbiAnNC4wLjAnCgpjb2Rlc3lzdGVtICJMT0lOQyI6ICdodHRwOi8vbG9pbmMub3JnJwoKY29kZSAiQmlydGggZGF0ZSI6ICcyMTExMi04JyBmcm9tICJMT0lOQyIgZGlzcGxheSAnQmlydGggZGF0ZScKY29kZSAiQmxvb2QgcHJlc3N1cmUiOiAnODUzNTQtOScgZnJvbSAiTE9JTkMiIGRpc3BsYXkgJ2Jsb29kIHByZXNzdXJlJwpjb2RlICJEaWFzdG9saWMgYmxvb2QgcHJlc3N1cmUiOiAnODQ2Mi00JyBmcm9tICJMT0lOQyIgZGlzcGxheSAnRGlhc3RvbGljIGJsb29kIHByZXNzdXJlJwpjb2RlICJTeXN0b2xpYyBibG9vZCBwcmVzc3VyZSI6ICc4NDgwLTYnIGZyb20gIkxPSU5DIiBkaXNwbGF5ICdTeXN0b2xpYyBibG9vZCBwcmVzc3VyZScKCi8vIHBhcmFtZXRlciAiTWVhc3VyZW1lbnQgUGVyaW9kIiBJbnRlcnZhbDxEYXRlVGltZT4KcGFyYW1ldGVyIEluY2x1c2lvbk9ic2VydmF0aW9uc0xvb2tiYWNrUGVyaW9kIGRlZmF1bHQgOTAgZGF5cwoKY29udGV4dCBQYXRpZW50CgovLyBDb21tb24gRnVuY3Rpb25zCgpkZWZpbmUgZnVuY3Rpb24gIkdldElkIih1cmkgU3RyaW5nKToKCUxhc3QoU3BsaXQodXJpLCAnLycpKQoKZGVmaW5lIGZ1bmN0aW9uIEdldEVuY291bnRlcihyZWZlcmVuY2UgUmVmZXJlbmNlKToKICBzaW5nbGV0b24gZnJvbSAoIFtFbmNvdW50ZXI6IGlkIGluIEdldElkKHJlZmVyZW5jZS5yZWZlcmVuY2UpXSApCgpkZWZpbmUgZnVuY3Rpb24gTG9va0JhY2tJbnRlcnZhbChMb29rQmFjayBTeXN0ZW0uUXVhbnRpdHkpOgoJSW50ZXJ2YWxbTm93KCkgLSBMb29rQmFjaywgTm93KCldCgpkZWZpbmUgIk1lYXN1cmVtZW50IFBlcmlvZCI6CglMb29rQmFja0ludGVydmFsKEluY2x1c2lvbk9ic2VydmF0aW9uc0xvb2tiYWNrUGVyaW9kKQoKLy8gQmxvb2QgUHJlc3N1cmUgbG9naWMKCmRlZmluZSAiSGFzIERpYXN0b2xpYyBCbG9vZCBQcmVzc3VyZSBHcmVhdGVyIFRoYW4gOTAiOgoJIkxvd2VzdCBEaWFzdG9saWMgUmVhZGluZyBvbiBNb3N0IFJlY2VudCBCbG9vZCBQcmVzc3VyZSBEYXkiLnZhbHVlID4gOTAKCmRlZmluZSAiSGFzIFN5c3RvbGljIEJsb29kIFByZXNzdXJlIEdyZWF0ZXIgVGhhbiAxNDAiOgoJIkxvd2VzdCBTeXN0b2xpYyBSZWFkaW5nIG9uIE1vc3QgUmVjZW50IEJsb29kIFByZXNzdXJlIERheSIudmFsdWUgPiAxNDAKCmRlZmluZSAiSGFzIERpYXN0b2xpYyBCbG9vZCBQcmVzc3VyZSBMZXNzIFRoYW4gOTAiOgoJIkxvd2VzdCBEaWFzdG9saWMgUmVhZGluZyBvbiBNb3N0IFJlY2VudCBCbG9vZCBQcmVzc3VyZSBEYXkiLnZhbHVlIDwgOTAKCmRlZmluZSAiSGFzIFN5c3RvbGljIEJsb29kIFByZXNzdXJlIExlc3MgVGhhbiAxNDAiOgoJIkxvd2VzdCBTeXN0b2xpYyBSZWFkaW5nIG9uIE1vc3QgUmVjZW50IEJsb29kIFByZXNzdXJlIERheSIudmFsdWUgPCAxNDAKCmRlZmluZSAiTG93ZXN0IERpYXN0b2xpYyBSZWFkaW5nIG9uIE1vc3QgUmVjZW50IEJsb29kIFByZXNzdXJlIERheSI6CglMYXN0KAogICAgIlF1YWxpZnlpbmcgRGlhc3RvbGljIEJsb29kIFByZXNzdXJlIFJlYWRpbmciIERCUFJlYWRpbmcKLy8JCSAgd2hlcmUgREJQUmVhZGluZy5lZmZlY3RpdmUgc2FtZSBkYXkgYXMgIk1vc3QgUmVjZW50IEJsb29kIFByZXNzdXJlIERheSIKICAgICAgcmV0dXJuIHNpbmdsZXRvbiBmcm9tICgKICAgICAgICBEQlBSZWFkaW5nLmNvbXBvbmVudCBDCiAgICAgICAgICB3aGVyZSBDLmNvZGUgfiBUb0NvbmNlcHQoIkRpYXN0b2xpYyBibG9vZCBwcmVzc3VyZSIpCiAgICAgICAgICByZXR1cm4gQy52YWx1ZSBhcyBRdWFudGl0eQogICAgICApCgkJCS8qIHNvcnQgYXNjZW5kaW5nICovCgkpCgpkZWZpbmUgIkxvd2VzdCBTeXN0b2xpYyBSZWFkaW5nIG9uIE1vc3QgUmVjZW50IEJsb29kIFByZXNzdXJlIERheSI6CglMYXN0KAogICAgIlF1YWxpZnlpbmcgU3lzdG9saWMgQmxvb2QgUHJlc3N1cmUgUmVhZGluZyIgU0JQUmVhZGluZwovLwkJICB3aGVyZSBTQlBSZWFkaW5nLmVmZmVjdGl2ZSBzYW1lIGRheSBhcyAiTW9zdCBSZWNlbnQgQmxvb2QgUHJlc3N1cmUgRGF5IgogICAgICByZXR1cm4gc2luZ2xldG9uIGZyb20gKAogICAgICAgIFNCUFJlYWRpbmcuY29tcG9uZW50IEMKICAgICAgICAgIHdoZXJlIEMuY29kZSB+IFRvQ29uY2VwdCgiU3lzdG9saWMgYmxvb2QgcHJlc3N1cmUiKQogICAgICAgICAgcmV0dXJuIEMudmFsdWUgYXMgUXVhbnRpdHkKICAgICAgKQogICAgICAvKiBzb3J0IGFzY2VuZGluZyAqLwoJKQoKZGVmaW5lICJCbG9vZCBQcmVzc3VyZSBEYXlzIjoKCSggKCAiUXVhbGlmeWluZyBEaWFzdG9saWMgQmxvb2QgUHJlc3N1cmUgUmVhZGluZyIgREJQRXhhbQoJCQkJcmV0dXJuIGRhdGUgZnJvbSBEQlBFeGFtLmVmZmVjdGl2ZQoJCSkKCQkJaW50ZXJzZWN0ICggIlF1YWxpZnlpbmcgU3lzdG9saWMgQmxvb2QgUHJlc3N1cmUgUmVhZGluZyIgU0JQRXhhbQoJCQkJCXJldHVybiBkYXRlIGZyb20gU0JQRXhhbS5lZmZlY3RpdmUKCQkJKQoJKQoKZGVmaW5lICJNb3N0IFJlY2VudCBCbG9vZCBQcmVzc3VyZSBEYXkiOgoJTWF4KCJCbG9vZCBQcmVzc3VyZSBEYXlzIikKCmRlZmluZSAiUXVhbGlmeWluZyBEaWFzdG9saWMgQmxvb2QgUHJlc3N1cmUgUmVhZGluZyI6CglbT2JzZXJ2YXRpb246ICJCbG9vZCBwcmVzc3VyZSJdIEJsb29kUHJlc3N1cmUKCSAgd2hlcmUgQmxvb2RQcmVzc3VyZS5zdGF0dXMgaW4geydmaW5hbCcsICdhbWVuZGVkJ30KLy8gICAgICBhbmQgQmxvb2RQcmVzc3VyZS5lZmZlY3RpdmUgZHVyaW5nICJNZWFzdXJlbWVudCBQZXJpb2QiCi8vCSAgICBhbmQgbm90IChHZXRFbmNvdW50ZXIoQmxvb2RQcmVzc3VyZS5lbmNvdW50ZXIpLmNsYXNzLmNvZGUgaW4geyAnRU1FUicsICdJTVAnLCAnQUNVVEUnLCAnTk9OQUMnLCAnUFJFTkMnLCAnU1MnIH0pCiAgICAgIGFuZCBleGlzdHMgKAogICAgICAgIEJsb29kUHJlc3N1cmUuY29tcG9uZW50IERpYXN0b2xpY0JQCiAgICAgICAgICAvL3doZXJlIEZISVJIZWxwZXJzLlRvQ29uY2VwdChEaWFzdG9saWNCUC5jb2RlKSB+ICJEaWFzdG9saWMgYmxvb2QgcHJlc3N1cmUiCgkgICAgICAgIHdoZXJlIERpYXN0b2xpY0JQLmNvZGUgfiBUb0NvbmNlcHQoIkRpYXN0b2xpYyBibG9vZCBwcmVzc3VyZSIpCi8vICAgICAgICAgICAgYW5kIERpYXN0b2xpY0JQLnZhbHVlLnVuaXQgPSAnbW1bSGddJwovLyBUT0RPOiBDUUwgdHJhbnNsYXRpb24gZXJyb3Igb24gYWJvdmU6IEVycm9yOls4MjozNSwgODI6MzhdIG5hbWUgY2Fubm90IGJlIG51bGwKICAgICAgKQoKZGVmaW5lICJRdWFsaWZ5aW5nIFN5c3RvbGljIEJsb29kIFByZXNzdXJlIFJlYWRpbmciOgoJW09ic2VydmF0aW9uOiAiQmxvb2QgcHJlc3N1cmUiXSBCbG9vZFByZXNzdXJlCgkgIHdoZXJlIEJsb29kUHJlc3N1cmUuc3RhdHVzIGluIHsnZmluYWwnLCAnYW1lbmRlZCd9Ci8vICAgICAgYW5kIEJsb29kUHJlc3N1cmUuZWZmZWN0aXZlIGR1cmluZyAiTWVhc3VyZW1lbnQgUGVyaW9kIgogICAgICAvLyBUT0RPOiBUdXJuIHRoaXMgaW50byBhIHZhbHVlIHNldAovLwkgICAgYW5kIG5vdCAoR2V0RW5jb3VudGVyKEJsb29kUHJlc3N1cmUuZW5jb3VudGVyKS5jbGFzcy5jb2RlIGluIHsgJ0VNRVInLCAnSU1QJywgJ0FDVVRFJywgJ05PTkFDJywgJ1BSRU5DJywgJ1NTJ30pCiAgICAgIGFuZCBleGlzdHMgKAogICAgICAgIEJsb29kUHJlc3N1cmUuY29tcG9uZW50IFN5c3RvbGljQlAKICAgICAgICAgIC8vd2hlcmUgRkhJUkhlbHBlcnMuVG9Db25jZXB0KFN5c3RvbGljQlAuY29kZSkgfiAiU3lzdG9saWMgYmxvb2QgcHJlc3N1cmUiCgkgICAgICAgIHdoZXJlIFN5c3RvbGljQlAuY29kZSB+IFRvQ29uY2VwdCgiU3lzdG9saWMgYmxvb2QgcHJlc3N1cmUiKQovLyAgICAgICAgICAgIGFuZCBTeXN0b2xpY0JQLnZhbHVlLnVuaXQgPSAnbW1bSGddJwogICAgICApCg=="
    }
  ]
}
