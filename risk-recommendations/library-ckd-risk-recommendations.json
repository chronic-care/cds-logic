{
  "resourceType": "Library",
  "id": "ckd-risk-recommendations",
  "url": "http://hl7.org/fhir/uv/cpg/Library/ckd-risk-recommendations",
  "version": "1.0",
  "name": "CKDRiskLogic",
  "title": "Chronic Kidney Disease (CKD) risk screening logic",
  "status": "active",
  "experimental": true,
  "type": {
    "coding": [
      {
        "system": "http://terminology.hl7.org/CodeSystem/library-type",
        "code": "logic-library"
      }
    ]
  },
  "content": [
    {
      "contentType": "application/cql",
      "data": "bGlicmFyeSBDS0RSaXNrTG9naWMgdmVyc2lvbiAnMS4wJwoKdXNpbmcgRkhJUiB2ZXJzaW9uICc0LjAuMCcKCmluY2x1ZGUgRkhJUkhlbHBlcnMgdmVyc2lvbiAnNC4wLjAnIGNhbGxlZCBGSElSSGVscGVycwoKY29kZXN5c3RlbSAiU05PTUVEQ1QiOiAnaHR0cDovL3Nub21lZC5pbmZvL3NjdCcKY29kZXN5c3RlbSAiTE9JTkMiOiAnaHR0cDovL2xvaW5jLm9yZycKY29kZXN5c3RlbSAiUnhOb3JtIjogJ2h0dHA6Ly93d3cubmxtLm5paC5nb3YvcmVzZWFyY2gvdW1scy9yeG5vcm0nCgp2YWx1ZXNldCAiQ2hyb25pYyBLaWRuZXkgRGlzZWFzZSI6ICdja2QtdmFsdWVzZXQtY2tkJwp2YWx1ZXNldCAiRGlhYmV0ZXMgbWVsbGl0dXMiOiAnY2tkLXZhbHVlc2V0LWRpYWJldGVzJwoKdmFsdWVzZXQgImVHRlIgTGFicyI6ICdja2QtdmFsdWVzZXQtZWdmcicKdmFsdWVzZXQgIlVBQ1IgTGFicyI6ICdja2QtdmFsdWVzZXQtdWFjcicKdmFsdWVzZXQgIkNyZWF0aW5pbmUgTGFicyI6ICdja2QtdmFsdWVzZXQtY3JlYXRpbmluZScKCmNvZGUgIkJsb29kIHByZXNzdXJlIHN5c3RvbGljIGFuZCBkaWFzdG9saWMiOiAnNTUyODQtNCcgZnJvbSAiTE9JTkMiCgpjb250ZXh0IFBhdGllbnQKCi8vIENvbmRpdGlvbnMKLy8KZGVmaW5lICJIYXMgQ0tEIG9yIERpYWJldGVzIjoKICAiSGFzIENLRCIgb3IgIkhhcyBEaWFiZXRlcyIKCmRlZmluZSAiSGFzIENLRCI6CiAgZXhpc3RzKCAiQ2hyb25pYyBLaWRuZXkgRGlzZWFzZSBEeCIgKQoKZGVmaW5lICJIYXMgRGlhYmV0ZXMiOgogIGV4aXN0cyggIkRpYWJldGVzIER4IiApCgpkZWZpbmUgIkNLRCBvciBEaWFiZXRlcyBEeCI6CiAgIkNocm9uaWMgS2lkbmV5IERpc2Vhc2UgRHgiIHVuaW9uICJEaWFiZXRlcyBEeCIKCmRlZmluZSAiQ2hyb25pYyBLaWRuZXkgRGlzZWFzZSBEeCI6CiAgW0NvbmRpdGlvbjogY29kZSBpbiAiQ2hyb25pYyBLaWRuZXkgRGlzZWFzZSJdIGNvbmRpdGlvbgogICAgd2hlcmUgY29uZGl0aW9uLmNsaW5pY2FsU3RhdHVzLnZhbHVlIGluIHsgJ2FjdGl2ZScsICdyZWN1cnJlbmNlJyB9CgpkZWZpbmUgIkRpYWJldGVzIER4IjoKICBbQ29uZGl0aW9uOiBjb2RlIGluICJEaWFiZXRlcyBtZWxsaXR1cyJdIGNvbmRpdGlvbgogICAgd2hlcmUgY29uZGl0aW9uLmNsaW5pY2FsU3RhdHVzLnZhbHVlIGluIHsgJ2FjdGl2ZScsICdyZWN1cnJlbmNlJyB9CgovLyBMYWJvcmF0b3J5IG9ic2VydmF0aW9ucwovLwpkZWZpbmUgIkhhcyBlR0ZSIG9yIFVBQ1IgTGFiIjoKICAiTGFzdCBlR0ZSIExhYiBSZXN1bHQiIGlzIG5vdCBudWxsCglvciAiTGFzdCBVQUNSIExhYiBSZXN1bHQiIGlzIG5vdCBudWxsCgpkZWZpbmUgIkxhc3QgZUdGUiBMYWIgUmVzdWx0IjoKICBMYXN0KCBbT2JzZXJ2YXRpb246IGNvZGUgaW4gImVHRlIgTGFicyJdICkKCmRlZmluZSAiTGFzdCBlR0ZSIFF1YW50aXR5IjoKICAiTGFzdCBlR0ZSIExhYiBSZXN1bHQiIFJlc3VsdAogICAgcmV0dXJuIFRvUXVhbnRpdHkoUmVzdWx0LnZhbHVlIGFzIFF1YW50aXR5KQoKZGVmaW5lICJIYXMgQWJub3JtYWwgZUdGUiI6CiAgIkxhc3QgZUdGUiBRdWFudGl0eSIudmFsdWUgPCA2MAoKZGVmaW5lICJMYXN0IFVBQ1IgTGFiIFJlc3VsdCI6CiAgTGFzdCggW09ic2VydmF0aW9uOiBjb2RlIGluICJVQUNSIExhYnMiXSApCgpkZWZpbmUgIkxhc3QgVUFDUiBRdWFudGl0eSI6CiAgIkxhc3QgVUFDUiBMYWIgUmVzdWx0IiBSZXN1bHQKICAgIHJldHVybiBUb1F1YW50aXR5KFJlc3VsdC52YWx1ZSBhcyBRdWFudGl0eSkKCmRlZmluZSAiSGFzIEFibm9ybWFsIFVBQ1IiOgogICJMYXN0IFVBQ1IgUXVhbnRpdHkiIHVhY3IKICAgIHJldHVybiBVQUNSdG9NZXRyaWModWFjcikudmFsdWUgPiAzMAoKZGVmaW5lICJMYXN0IENyZWF0aW5pbmUgTGFiIFJlc3VsdCI6CiAgTGFzdCggW09ic2VydmF0aW9uOiBjb2RlIGluICJDcmVhdGluaW5lIExhYnMiXSApCgpkZWZpbmUgIkxhc3QgQ3JlYXRpbmluZSBRdWFudGl0eSI6CiAgIkxhc3QgQ3JlYXRpbmluZSBMYWIgUmVzdWx0IiBSZXN1bHQKICAgIHJldHVybiBUb1F1YW50aXR5KFJlc3VsdC52YWx1ZSBhcyBRdWFudGl0eSkKCmRlZmluZSAiTmVlZHMgZUdGUiBMYWIiOgoJImVHRlIgTGFiIGlzIE92ZXJkdWUiCgkJb3IgKCJlR0ZSIExhYiBGcmVxdWVuY3kiIGlzIG5vdCBudWxsIGFuZCAiTGFzdCBlR0ZSIExhYiBSZXN1bHQiIGlzIG51bGwpCgpkZWZpbmUgImVHRlIgTGFiIEZyZXF1ZW5jeSI6CgljYXNlCgkJd2hlbiAiQ0tEIFN0YWdlIiA+PSA0CgkJCXRoZW4gMyBtb250aHMKCQl3aGVuICJDS0QgU3RhZ2UiID49IDMKCQkJdGhlbiA2IG1vbnRocwoJCXdoZW4gIkhhcyBDS0Qgb3IgRGlhYmV0ZXMiCgkJCXRoZW4gMTIgbW9udGhzCgkJZWxzZSBudWxsCgllbmQKCmRlZmluZSAiZUdGUiBMYWIgaXMgT3ZlcmR1ZSI6CiAgIkxhc3QgZUdGUiBMYWIgUmVzdWx0IiBSZXN1bHQKICAgIHJldHVybgogICAgICBjYXNlCiAgICAgICAgd2hlbiBSZXN1bHQuZWZmZWN0aXZlIGlzIG51bGwKICAgICAgICAgIHRoZW4gdHJ1ZQogICAgICAgIHdoZW4gUmVzdWx0LmVmZmVjdGl2ZSBpcyBkYXRlVGltZQogICAgICAgICAgdGhlbiAoUmVzdWx0LmVmZmVjdGl2ZS52YWx1ZSArICJlR0ZSIExhYiBGcmVxdWVuY3kiKSA8IFRvZGF5KCkKICAgICAgICB3aGVuIFJlc3VsdC5lZmZlY3RpdmUgaXMgUGVyaW9kCiAgICAgICAgICB0aGVuIChlbmQgb2YgUGVyaW9kVG9JbnRlcnZhbChSZXN1bHQuZWZmZWN0aXZlKSArICJlR0ZSIExhYiBGcmVxdWVuY3kiKSA8IFRvZGF5KCkKICAgICAgICBlbHNlIGZhbHNlCiAgICAgIGVuZAoKZGVmaW5lIE5lZWRzR0ZSU3VtbWFyeTogJ09yZGVyIFJlbmFsIExhYiBQYW5lbCcKCmRlZmluZSBOZWVkc0dGUkRldGFpbDoKCWNhc2UKCQl3aGVuICJDS0QgU3RhZ2UiID49IDEKCQkJdGhlbiAnZUdGUiBsYWIgcmVjb21tZW5kZWQgZXZlcnkgJyArIFRvU3RyaW5nKCJlR0ZSIExhYiBGcmVxdWVuY3kiKSArICcgZm9yIFN0YWdlICcgKyBUb1N0cmluZygiQ0tEIFN0YWdlIikgKyAnIENLRC4nCgkJd2hlbiAiSGFzIENLRCBvciBEaWFiZXRlcyIKCQkJdGhlbiAnZUdGUiBsYWIgcmVjb21tZW5kZWQgZXZlcnkgJyArIFRvU3RyaW5nKCJlR0ZSIExhYiBGcmVxdWVuY3kiKSArICcgZm9yIENLRCBvciBEaWFiZXRlcy4nCgkJZWxzZSBudWxsCgllbmQKCmRlZmluZSBOZWVkc0dGUlNldmVyaXR5OiAnaW5mbycKCmRlZmluZSAiQ0tEIFN0YWdlIjoKICAiTGFzdCBlR0ZSIFF1YW50aXR5IiBlZ2ZyCiAgCXJldHVybiBjYXNlCiAgICAgIHdoZW4gZWdmci52YWx1ZSA8IDE1CiAgICAJCXRoZW4gNQogICAgCXdoZW4gZWdmci52YWx1ZSA8IDMwCiAgICAJCXRoZW4gNAogICAgCXdoZW4gZWdmci52YWx1ZSA8IDYwCiAgICAJCXRoZW4gMwogICAgCXdoZW4gZWdmci52YWx1ZSA8IDkwCiAgICAJCXRoZW4gMgogICAgCXdoZW4gZWdmci52YWx1ZSA+PSA5MAogICAgICAgIC8vIFRPRE8gdGhpcyBkb2VzIG5vdCBwYXJzZQogICAgICAgIC8vY2FzZSAgd2hlbiBVQUNSdG9NZXRyaWMoIkdldCBVQUNSIFF1YW50aXR5IikudmFsdWUgPiAyMAogIAkJICAvLyAgdGhlbiAxCiAgICAgICAgLy9lbHNlIDAKICAgICAgICAvL2VuZAogICAgICAgIHRoZW4gMAogICAgICBlbHNlIDAKICAJZW5kCgovLyBSZWZlcnJhbHMKLy8KZGVmaW5lICJSZWNvbW1lbmQgTmVwaHJvbG9neSBSZWZlcnJhbCI6CgkiNS1ZZWFyIFJpc2sgTGV2ZWwiID0gJ0hpZ2gnCgpkZWZpbmUgTmVwaHJvbG9neVJlZmVycmFsRGV0YWlsOiAnUmVmZXJyYWwgdG8gYSBuZXBocm9sb2dpc3QgaXMgcmVjb21tZW5kZWQgd2hlbiA1LXllYXIgcmlzayBpcyBIaWdoJwoKZGVmaW5lIE5lcGhyb2xvZ3lSZWZlcnJhbFNldmVyaXR5OiAnaW5mbycKCi8vCi8vIFRhbmdyaSBDS0QgcmlzayBtb2RlbAovLwovLyA0IHZhcmlhYmxlCi8vIDEg4oCTIDAuOTc1MCBeIGV4cCAoLTAuMjIwMSDDlyAoYWdlLzEwIOKAkyA3LjAzNikgKyAwLjI0Njcgw5cgKG1hbGUg4oCTIDAuNTY0Mikg4oCTIDAuNTU2NyDDlyAoZUdGUi81IOKAkyA3LjIyMikgKyAwLjQ1MTAgw5cgKGxvZ0FDUiDigJMgNS4xMzcpKQovLyA1IHllYXIgZmFjdG9yID0gIDAuOTI0MAovLwovLyA4IHZhcmlhYmxlCi8vIDEg4oCTIDAuOTc4MCBeIGV4cCAoLTAuMTk5MiDDlyAoYWdlLzEwIOKAkyA3LjAzNikgKyAwLjE2MDIgw5cgKG1hbGUg4oCTIDAuNTY0Mikg4oCTIDAuNDkxOSDDlyAoZUdGUi81IOKAkyA3LjIyMikgKyAwLjMzNjQgw5cgKGxvZ0FDUiDigJMgNS4xMzcpCi8vCQnigJMgMC4zNDQxIMOXIChhbGJ1bWluIOKAkyAzLjk5NykgKyAwLjI2MDQgw5cgKHBob3NwaG9yb3VzIOKAkyAzLjkxNikg4oCTIDAuMDczNTQgw5cgKGJpY2FyYm9uYXRlIOKAkyAyNS41Nykg4oCTIDAuMjIyOCDDlyAoY2FsY2l1bSDigJMgOS4zNTUpKQovLyA1IHllYXIgZmFjdG9yID0gMC45MzAxCgpkZWZpbmUgIjItWWVhclJpc2tEZXRhaWwiOgoJJzIteWVhciBraWRuZXkgZmFpbHVyZSByaXNrIG9mICcgKyBUb1N0cmluZygiMi1ZZWFyIENLRCBSaXNrIFBlcmNlbnQiKSArICclIGlzIGNvbnNpZGVyZWQgdG8gYmUgJyArICIyLVllYXIgUmlzayBMZXZlbCIgKyAnIHJpc2suJwoKZGVmaW5lICI1LVllYXJSaXNrRGV0YWlsIjoKCSc1LXllYXIga2lkbmV5IGZhaWx1cmUgcmlzayBvZiAnICsgVG9TdHJpbmcoIjUtWWVhciBDS0QgUmlzayBQZXJjZW50IikgKyAnJSBpcyBjb25zaWRlcmVkIHRvIGJlICcgKyAiNS1ZZWFyIFJpc2sgTGV2ZWwiICsgJyByaXNrLicKCmRlZmluZSAiMi1ZZWFyUmlza1NldmVyaXR5IjogaWYgIjItWWVhciBSaXNrIExldmVsIiA9ICdIaWdoJyB0aGVuICd3YXJuaW5nJyBlbHNlICdpbmZvJwoKZGVmaW5lICI1LVllYXJSaXNrU2V2ZXJpdHkiOiBpZiAiNS1ZZWFyIFJpc2sgTGV2ZWwiID0gJ0hpZ2gnIHRoZW4gJ3dhcm5pbmcnIGVsc2UgJ2luZm8nCgpkZWZpbmUgIjItWWVhciBDS0QgUmlzayBQZXJjZW50IjoKICAiMi1ZZWFyIENLRCBSaXNrIiByaXNrCiAgICByZXR1cm4gUm91bmQocmlzayAqIDEwMCwgMikKCmRlZmluZSAiNS1ZZWFyIENLRCBSaXNrIFBlcmNlbnQiOgogICI1LVllYXIgQ0tEIFJpc2siIHJpc2sKICAgIHJldHVybiBSb3VuZChyaXNrICogMTAwLCAyKQoKZGVmaW5lICIyLVllYXIgQ0tEIFJpc2siOgogICJMYXN0IGVHRlIgUXVhbnRpdHkiIGVnZnIKICAgIHJldHVybiBjYWxjdWxhdGVDa2RSaXNrKDAuOTc1MCwgMCwgQWdlSW5ZZWFycygpLCBlZ2ZyLCBVQUNSdG9NZXRyaWMoIkxhc3QgVUFDUiBRdWFudGl0eSIpKQoKZGVmaW5lICI1LVllYXIgQ0tEIFJpc2siOgogICJMYXN0IGVHRlIgUXVhbnRpdHkiIGVnZnIKICAgIHJldHVybiBjYWxjdWxhdGVDa2RSaXNrKDAuOTI0MCwgMCwgQWdlSW5ZZWFycygpLCBlZ2ZyLCBVQUNSdG9NZXRyaWMoIkxhc3QgVUFDUiBRdWFudGl0eSIpKQoKLy8gVGhlIGNrZEZhY3RvciBpcyBhIHZhcmlhYmxlIGRldGVybWluZWQgYnkgKE5vbi0pIE5vcnRoIEFtZXJpY2FuIGxvY2F0aW9uIGFuZCB3aGV0aGVyIGNhbGN1bGF0aW9uIGlzIDIgb3IgNSB5ZWFyIHByZWRpY3Rpb24KZGVmaW5lIGZ1bmN0aW9uIGNhbGN1bGF0ZUNrZFJpc2soY2tkRmFjdG9yIERlY2ltYWwsIHNleCBJbnRlZ2VyLCBhZ2UgSW50ZWdlciwgZWdmciBTeXN0ZW0uUXVhbnRpdHksIGFjciBTeXN0ZW0uUXVhbnRpdHkpOgogIDEuMCAtIFBvd2VyKGNrZEZhY3RvciwgRXhwKC0wLjIyMDEgKiAoYWdlIC8gMTAgLSA3LjAzNikgKyAwLjI0NjcgKiAoc2V4IC0gMC41NjQyKSAtIDAuNTU2NyAqIChlZ2ZyLnZhbHVlIC8gNSAtIDcuMjIyKSArIDAuNDUxMCAqIChMbihhY3IudmFsdWUpIC0gNS4xMzcpKSkKCmRlZmluZSAiMi1ZZWFyIFJpc2sgTGV2ZWwiOgogICIyLVllYXIgQ0tEIFJpc2sgUGVyY2VudCIgcmlza1BlcmNlbnQKICAJcmV0dXJuIGNhc2UKICAgICAgd2hlbiByaXNrUGVyY2VudCA8IDUKICAgIAkJdGhlbiAnTG93JwogICAgCXdoZW4gcmlza1BlcmNlbnQgPCAxNQogICAgCQl0aGVuICdJbnRlcm1lZGlhdGUnCiAgICAJd2hlbiByaXNrUGVyY2VudCA+IDE1CiAgICAJCXRoZW4gJ0hpZ2gnCiAgICAgIGVsc2UgbnVsbAogIAllbmQKCmRlZmluZSAiNS1ZZWFyIFJpc2sgTGV2ZWwiOgogICI1LVllYXIgQ0tEIFJpc2sgUGVyY2VudCIgcmlza1BlcmNlbnQKICAJcmV0dXJuIGNhc2UKICAgICAgd2hlbiByaXNrUGVyY2VudCA8IDUKICAgIAkJdGhlbiAnTG93JwogICAgCXdoZW4gcmlza1BlcmNlbnQgPCAxNQogICAgCQl0aGVuICdJbnRlcm1lZGlhdGUnCiAgICAJd2hlbiByaXNrUGVyY2VudCA+IDE1CiAgICAJCXRoZW4gJ0hpZ2gnCiAgICAgIGVsc2UgbnVsbAogIAllbmQKCi8vIENvbnZlcnNpb24gZnVuY3Rpb25zCgpkZWZpbmUgZnVuY3Rpb24gUGVyaW9kVG9JbnRlcnZhbCh2YWx1ZSBGSElSLlBlcmlvZCk6CglJbnRlcnZhbFt2YWx1ZS4ic3RhcnQiLnZhbHVlLCB2YWx1ZS4iZW5kIi52YWx1ZV0KCmRlZmluZSBmdW5jdGlvbiBDb2RpbmdUb0NvZGUoY29kaW5nIEZISVIuQ29kaW5nKToKCVN5c3RlbS5Db2RlIHsKCQljb2RlOiBjb2RpbmcuY29kZS52YWx1ZSwKCQlzeXN0ZW06IGNvZGluZy5zeXN0ZW0udmFsdWUsCgkJdmVyc2lvbjogY29kaW5nLnZlcnNpb24udmFsdWUsCgkJZGlzcGxheTogY29kaW5nLmRpc3BsYXkudmFsdWUKCX0KCmRlZmluZSBmdW5jdGlvbiBUb0NvbmNlcHQoY29uY2VwdCBGSElSLkNvZGVhYmxlQ29uY2VwdCk6CiAgICBTeXN0ZW0uQ29uY2VwdCB7CiAgICAgICAgY29kZXM6IGNvbmNlcHQuY29kaW5nIEMgcmV0dXJuIENvZGluZ1RvQ29kZShDKSwKICAgICAgICBkaXNwbGF5OiBjb25jZXB0LnRleHQudmFsdWUKICAgIH0KCmRlZmluZSBmdW5jdGlvbiBUb1F1YW50aXR5KHF1YW50aXR5IEZISVIuUXVhbnRpdHkpOgogICAgU3lzdGVtLlF1YW50aXR5IHsKICAgICAgICB2YWx1ZTogcXVhbnRpdHkudmFsdWUudmFsdWUsCiAgICAgICAgdW5pdDogcXVhbnRpdHkudW5pdC52YWx1ZQogICAgfQoKZGVmaW5lIGZ1bmN0aW9uIFVBQ1J0b01ldHJpYyhxdHkgU3lzdGVtLlF1YW50aXR5KToKCWNhc2Ugd2hlbiBxdHkudW5pdCA9ICdtZy9tbW9sIGNyZWF0aW5pbmUnIHRoZW4KCQlTeXN0ZW0uUXVhbnRpdHkgeyB2YWx1ZTogcXR5LnZhbHVlICogOC44NCwgdW5pdDogJ21nL2cnIH0KCXdoZW4gcXR5LnVuaXQgPSAnbWcvZycgdGhlbgogICAgcXR5CgllbHNlCiAgICAvLyB1bmtub3duIHVuaXRzLCBpZ25vcmUgdGhpcyBxdWFudGl0eSBpbiBjYWxjdWxhdGlvbgoJCW51bGwKCWVuZAoKZGVmaW5lIGZ1bmN0aW9uIFRvTWV0cmljKHF0eSBTeXN0ZW0uUXVhbnRpdHkpOgoJY2FzZSB3aGVuIHF0eS51bml0ID0gJ2xiJyB0aGVuCgkJU3lzdGVtLlF1YW50aXR5IHsgdmFsdWU6IHF0eS52YWx1ZSAqIDAuNDU0LCB1bml0OiAna2cnIH0KCXdoZW4gcXR5LnVuaXQgPSAnaW4nIHRoZW4KCQlTeXN0ZW0uUXVhbnRpdHkgeyB2YWx1ZTogcXR5LnZhbHVlICogMC4wMjU0LCB1bml0OiAnbScgfQoJZWxzZQoJCXF0eQoJZW5kCg=="
    }
  ]
}
